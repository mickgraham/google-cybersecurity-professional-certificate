# Module 3: Incident Investigation and Response

## Overview

* Investigate and verify an incident
* Plans and processes behind incident response
* Post-incident actions

## Investigate and Verify an Incident

Investigating and validating security alerts occurs during the Detection and Analysis phase of the NIST Incident Response Lifecycle.

Not all events are incidents, but all incidents are events, with incidents being detected when malicious activity, like unauthorised access, occurs. Analysis involves investigating and validating alerts generated by detection tools like IDS and SIEM. Security analysts use critical thinking and incident analysis skills to examine indicators of compromise and determine if an incident has truly occurred.

Challenges in detection and analysis:

* It's impossible to detect everything due to tool limitations and incomplete deployment across organizations.
* Analysts often face a high volume of alerts, many of which can be false positives caused by misconfigured alert settings.

### Methods of detection

During the Detection and Analysis Phase of the incident response lifecycle, security teams are notified of a possible incident and work to investigate and verify the incident by collecting and analysing data. **Detection** refers to the prompt discovery of security events and **analysis** involves the investigation and validation of alerts.

### Threat Hunting

* **Proactive Threat Search:** Threat hunting involves actively searching for hidden threats on a network that automated tools might miss, combining technology with human analysis.
* **Identifying Evasive Threats:** This method is particularly effective for detecting sophisticated threats like fileless malware, which can evade traditional signature-based detection.

#### Threat Intelligence and Cyber Deception

* **Contextual Threat Information:** Threat intelligence, sourced from industry reports, government advisories, and data feeds, provides crucial context about existing and emerging threats to enhance detection capabilities.
* **Deceiving Malicious Actors:** Cyber deception techniques, such as honeypots, deliberately mislead attackers to increase detection rates and improve defensive strategies by luring them into decoy systems.

## Plans and Processes Behind Incident Response

Benefits of documentation:

* **Transparency:** Transparent documentation is useful as a source of evidence for security insurance claims, regulatory investigations, and legal proceedings.
* **Standardisation:** An established set of guidelines or standards to follow to complete a task or workflow to help maintain quality of work.
* **Clarity:** Effective documentation gives a clear understanding of roles and duties, and provides information on how to get the job done.

**Chain of custody** forms provide us with a method of maintaining evidence, so that malicious actors can be held responsible for their actions. As soon as evidence gets collected, chain of custody forms are introduced. First, there should be a description of the evidence, which includes any identifying information, like the location, hostname, MAC address, or IP address. Next is the custody log, which details the name of the people who transferred and received the evidence. It also includes the date and time the evidence was collected or transferred and the purpose of the transfer. A **broken chain of custody** occurs when there are inconsistencies or missing entries, which can compromise the integrity and admissibility of the evidence in legal settings.

**Playbooks** are like travel itineraries, providing detailed instructions for operational actions, especially during unpredictable and chaotic security incidents. They offer structure and order, helping security teams act quickly and effectively by reducing guesswork and uncertainty. Playbooks can be manual, semi-automated, or automated. They must be regularly updated and maintained to remain effective, as threats are constantly evolving. The post-incident activity phase is an ideal time to introduce necessary changes and updates to playbooks.

**Triage** is the prioritising of incidents according to their level of importance or urgency. The triage process helps security teams evaluate and prioritise security alerts and allocate resources effectively so that the most critical issues are addressed first. The triage process consists of three steps:

* Receive and assess
* Assign priority
* Collect and analyze

The third phase of the incident response lifecycle includes the steps for how security teams contain, eradicate, and recover from an incident. This phase of the lifecycle also integrates with the core functions of the NIST Cybersecurity Framework, **Respond and Recover**.

* **Containment:** is the act of limiting and preventing additional damage caused by an incident. Organizations outline their containment strategies in incident response plans.
Containment actions are the first step toward removing a threat from an environment. Once an incident has been contained, security teams work to remove all traces of the incident through eradication.
* **Eradication:** involves the complete removal of the incident elements from all affected systems. Actions include performing vulnerability tests and applying patches to vulnerabilities related to the threat.
* **Recovery:** is the process of returning affected systems back to normal operations. Actions include: re-imaging affected systems, resetting passwords, and adjusting network configurations like firewall rules.

Similar to an incident response plan, a **business continuity plan (BCP)** is a document that outlines the procedures to sustain business operations during and after a significant disruption. A BCP helps organizations ensure that critical business functions can resume or can be quickly restored when an incident occurs.

## Post-Incident Actions

The post-incident activity phase entails the process of reviewing an incident to identify areas for improvement during incident handling. During this phase of the lifecycle, different types of documentation get updated or created.

* **Final Report:** A comprehensive document detailing the incident's timeline, events, and recommendations for future prevention.
* **Lessons Learned Meeting:** Held within two weeks of an incident, this meeting involves all parties to discuss what happened, actions taken, and their effectiveness, using the final report as a reference.

## Glossary: Incident Investigation and Response

**Analysis:** The investigation and validation of alerts

**Broken chain of custody:** Inconsistencies in the collection and logging of evidence in the chain of custody

**Business continuity plan (BCP):** A document that outlines the procedures to sustain business operations during and after a significant disruption

**Chain of custody:** The process of documenting evidence possession and control during an incident lifecycle

**Containment:** The act of limiting and preventing additional damage caused by an incident

**Crowdsourcing:** The practice of gathering information using public input and collaboration

**Detection:** The prompt discovery of security events

**Documentation:** Any form of recorded content that is used for a specific purpose

**Eradication:** The complete removal of the incident elements from all affected systems

**Final report:** Documentation that provides a comprehensive review of an incident

**Honeypot:** A system or resource created as a decoy vulnerable to attacks with the purpose of attracting potential intruders

**Incident response plan:** A document that outlines the procedures to take in each step of incident response

**Indicators of attack (IoA):** The series of observed events that indicate a real-time incident

**Indicators of compromise (IoC):** Observable evidence that suggests signs of a potential security incident

**Intrusion detection system (IDS):** An application that monitors system activity and alerts on possible intrusions

**Lessons learned meeting:** A meeting that includes all involved parties after a major incident

**Open-source intelligence (OSINT):** The collection and analysis of information from publicly available sources to generate usable intelligence

**Playbook:** A manual that provides details about any operational action

**Post-incident activity:** The process of reviewing an incident to identify areas for improvement during incident handling

**Recovery:** The process of returning affected systems back to normal operations

**Resilience:** The ability to prepare for, respond to, and recover from disruptions

**Standards:** References that inform how to set policies

**Threat hunting:** The proactive search for threats on a network

**Threat intelligence:** Evidence-based threat information that provides context about existing or emerging threats

**Triage:** The prioritising of incidents according to their level of importance or urgency

**VirusTotal:** A service that allows anyone to analyze suspicious files, domains, URLs, and IP addresses for malicious content
